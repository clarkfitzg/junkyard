## HW4

Stats 206

Clark Fitzgerald

```{r setup, include=FALSE}
# Use pdf plots rather than jpeg.
opts_chunk$set(dev = 'pdf')
library(plyr)
```

## 1a

```{r, scatterplot, echo=FALSE}
setwd('~/junkyard/STA206/hw4')
property = read.table('property.txt')
names(property) = c('Y', 'X1', 'X2', 'X3', 'X4')
plot(property)
cor(property)
```

There are no obviously strong linear relationships here. $X_2$ and $X_4$
exhibit the largest correlations.

## 1b

The least squares estimates, $R^2$, and $R^2_a$ can be read from the
model summary output:

```{r, echo=FALSE}
fit1 = lm(Y ~ ., data = property)
summary(fit1)
```

The fitted regression equation is:
$$
    Y = 12.2 - 0.142 X_1 + 0.282 X_2 + 0.619 X_3 + 7.92 \times 10^{-6} X_4
$$

MSE is 1.293 from the ANOVA table. 
```{r, echo=FALSE}
anova(fit1)
```

## 1c

```{r, Residuals, echo=FALSE, fig.height = 4}
par(mfrow=c(1, 3))

plot.lm(fit1, which=c(1, 2))
boxplot(fit1$residuals)
```

The residuals versus fitted graph shows no clear patterns, which is good.
We can see from the QQ plot that the tails of the distribution are light.

## 1d

```{r, Residuals and Main Effects, echo=FALSE}
par(mfrow=c(2, 2))

plotone = function(x) {
    plot(fit1$residuals, property[, x], xlab='residuals', ylab=x)
}

sapply(c('X1', 'X2', 'X3', 'X4'), plotone)
```

```{r, Residuals Versus Main Effects, echo=FALSE}
par(mfrow=c(3, 2))

plot.interact = function(xx) {
    # xx is a vector of the columns names to select
    d = property[, xx]
    interaction = d[, 1] * d[, 2]
    plot(fit1$residuals, interaction, xlab='residuals',
         ylab=paste(xx, collapse = ' * '))
}

apply(combn(c('X1', 'X2', 'X3', 'X4'), 2), 2, plot.interact)
```

